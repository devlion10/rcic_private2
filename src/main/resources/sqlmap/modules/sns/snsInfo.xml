<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by Celerio, a Jaxio product.
 ! Documentation: http://www.jaxio.com/documentation/celerio/
 ! Follow us on twitter: @jaxiosoft
 ! Need commercial support ? Contact us: info@jaxio.com
 ! Template pack-rcic:src/main/resources/sqlmap/modules/SqlMap.e.vm.xml
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper">

    <resultMap id="snsInfoResultMap" type="kr.or.lx.rcic.modules.snsInfo.entity.SnsInfo">
        <!-- sns_no -->
        <result property="snsNo" column="sns_no"/>
        <!-- 1: twitter, 2: facebook -->
        <result property="snsType" column="sns_type"/>
        <!-- 키워드 -->
        <result property="snsKeyword" column="sns_keyword"/>
        <!-- 컨텐츠 -->
        <result property="snsContent" column="sns_content"/>
        <!-- sns_계정 -->
        <result property="snsAccount" column="sns_account"/>
        <!-- sns_url -->
        <result property="snsUrl" column="sns_url"/>
        <!-- sns_수집시각 -->
        <result property="snsRegistDt" column="sns_regist_dt"/>
        <!-- sns_글등록시간 -->
        <result property="snsCreateDt" column="sns_create_dt"/>
        <!-- sns_profile_img -->
        <result property="snsProfileImg" column="sns_profile_img"/>
        <!-- sns_ID -->
        <result property="snsId" column="sns_id"/>
        <!-- sns_프로필 백그라운드 컬러 -->
        <result property="snsProfileBackgroundColor" column="sns_profile_background_color"/>
        <!-- sns_프로필 텍스트 컬러 -->
        <result property="snsProfileTextColor" column="sns_profile_text_color"/>
        <!-- sns_profile_https_img -->
        <result property="snsProfileHttpsImg" column="sns_profile_https_img"/>
        <!-- sns_name -->
        <result property="snsName" column="sns_name"/>
        <!-- sns_description -->
        <result property="snsDescription" column="sns_description"/>
        <!-- sns수집 기준일 -->
        <result property="stdrDt" column="stdr_dt"/>
        <!-- 타이머 -->
        <result property="snsTimer" column="sns_timer"/>
        <!-- UTM-K X좌표 -->
        <result property="utmkX" column="utmk_x"/>
        <!-- UTM-K Y좌표 -->
        <result property="utmkY" column="utmk_y"/>
    </resultMap>

    <sql id="whereConditions">
        <where>
            <include refid="conditions" />
        </where>
    </sql>

    <sql id="conditions">
        <if test="snsNo != null">
            AND sns_no = #{snsNo}
        </if>
        <if test="snsType != null and snsType != ''">
            AND sns_type = #{snsType}
        </if>
        <if test="snsKeyword != null and snsKeyword != ''">
            AND sns_keyword = #{snsKeyword}
        </if>
        <if test="snsContent != null and snsContent != ''">
            AND sns_content = #{snsContent}
        </if>
        <if test="snsAccount != null and snsAccount != ''">
            AND sns_account = #{snsAccount}
        </if>
        <if test="snsUrl != null and snsUrl != ''">
            AND sns_url = #{snsUrl}
        </if>
        <if test="snsRegistDt != null and snsRegistDt.enabled == true">
            
            <if test="snsRegistDtFrom != null and snsRegistDtFrom != ''">
            AND sns_regist_dt <![CDATA[ >= ]]> STR_TO_DATE(#{snsRegistDtFrom}, '%Y.%m.%d')
            </if>

            <if test="snsRegistDtTo != null and snsRegistDtTo != ''">
            AND sns_regist_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{snsRegistDtTo}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
        <if test="snsCreateDt != null and snsCreateDt != ''">
            AND sns_create_dt = #{snsCreateDt}
        </if>
        <if test="snsProfileImg != null and snsProfileImg != ''">
            AND sns_profile_img = #{snsProfileImg}
        </if>
        <if test="snsId != null and snsId != ''">
            AND sns_id = #{snsId}
        </if>
        <if test="snsProfileBackgroundColor != null and snsProfileBackgroundColor != ''">
            AND sns_profile_background_color = #{snsProfileBackgroundColor}
        </if>
        <if test="snsProfileTextColor != null and snsProfileTextColor != ''">
            AND sns_profile_text_color = #{snsProfileTextColor}
        </if>
        <if test="snsProfileHttpsImg != null and snsProfileHttpsImg != ''">
            AND sns_profile_https_img = #{snsProfileHttpsImg}
        </if>
        <if test="snsName != null and snsName != ''">
            AND sns_name = #{snsName}
        </if>
        <if test="snsDescription != null and snsDescription != ''">
            AND sns_description = #{snsDescription}
        </if>
        <if test="stdrDt != null and stdrDt != ''">
            AND stdr_dt = #{stdrDt}
        </if>
        <if test="snsTimer != null and snsTimer != ''">
            AND sns_timer = #{snsTimer}
        </if>
        <if test="utmkX != null">
            AND utmk_x = #{utmkX}
        </if>
        <if test="utmkY != null">
            AND utmk_y = #{utmkY}
        </if>
    </sql>

    <select id="getSnsInfo" parameterType="long" resultMap="snsInfoResultMap">
        /* kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper.getSnsInfo */

        SELECT
            sns_no, sns_type, sns_keyword, sns_content, sns_account, sns_url, sns_regist_dt, sns_create_dt, sns_profile_img, sns_id, sns_profile_background_color, sns_profile_text_color, sns_profile_https_img, sns_name, sns_description, stdr_dt, sns_timer, utmk_x, utmk_y
        FROM RCIC.TB_SNS_INFO
        WHERE
         sns_no = #{snsNo}
         AND  sns_id = #{snsId}
	</select>

    <select id="selectSnsInfoCnt" resultType="int">
        SELECT COUNT(*)
        FROM RCIC.TB_SNS_INFO
        <include refid="whereConditions" />
    </select>

    
    <select id="selectSnsInfoList" resultType="egovMap">
        <include refid="common.headerRow"/>
		 SELECT    
            ROW_NUMBER() OVER (ORDER BY NOTICE_NO) AS RNUM,
			SNS_NO, 
			SNS_TYPE, 
			SNS_KEYWORD, 
			SNS_CONTENT, 
			SNS_ACCOUNT, 
			SNS_URL,
			TO_CHAR(SNS_REGIST_DT, 'YYYY-MM-DD HH24:MI:SS' ) AS SNS_REGIST_DT, 
			TO_CHAR(SNS_CREATE_DT, 'YYYY-MM-DD HH24:MI:SS' ) AS SNS_CREATE_DT,
			SNS_PROFILE_IMG, 
			SNS_ID,
			SNS_PROFILE_BACKGROUND_COLOR, 
			SNS_PROFILE_TEXT_COLOR,
			SNS_PROFILE_HTTPS_IMG, 
			SNS_NAME, 
			SNS_DESCRIPTION, 
			STDR_DT, 
			SNS_TIMER,
			UTMK_X, 
			UTMK_Y
		FROM RCIC.TB_SNS_INFO  
        WHERE 1=1
         <if test="keyword != null and keyword != '' ">
			AND SJ LIKE CONCAT('%', #{keyword}, '%')
		</if>
     	ORDER BY SNS_REGIST_DT DESC 
         LIMIT  #{listCnt} OFFSET (#{currPage} - 1) * #{listCnt} 
	</select>

    <update id="updateSnsInfo" parameterType="kr.or.lx.rcic.modules.snsInfo.entity.SnsInfo">
        /* kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper.updateSnsInfo */

        UPDATE RCIC.TB_SNS_INFO
        SET
               sns_type = #{snsType}
                    , sns_keyword = #{snsKeyword}
                    , sns_content = #{snsContent}
                    , sns_account = #{snsAccount}
                    , sns_url = #{snsUrl}
                    , sns_regist_dt = #{snsRegistDt}
                    , sns_create_dt = #{snsCreateDt}
                    , sns_profile_img = #{snsProfileImg}
                    , sns_profile_background_color = #{snsProfileBackgroundColor}
                    , sns_profile_text_color = #{snsProfileTextColor}
                    , sns_profile_https_img = #{snsProfileHttpsImg}
                    , sns_name = #{snsName}
                    , sns_description = #{snsDescription}
                    , stdr_dt = #{stdrDt}
                    , sns_timer = #{snsTimer}
                    , utmk_x = #{utmkX}
                    , utmk_y = #{utmkY}
              WHERE
             sns_no = #{snsNo}
             AND  sns_id = #{snsId}
    </update>

    <update id="updateSnsInfoDynamic" parameterType="kr.or.lx.rcic.modules.snsInfo.entity.SnsInfo">
        /* kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper.updateSnsInfoDynamic */

        UPDATE RCIC.TB_SNS_INFO
            <set>
            <if test="snsType != null and snsType != ''">
                sns_type = #{snsType},
            </if>
            <if test="snsKeyword != null and snsKeyword != ''">
                sns_keyword = #{snsKeyword},
            </if>
            <if test="snsContent != null and snsContent != ''">
                sns_content = #{snsContent},
            </if>
            <if test="snsAccount != null and snsAccount != ''">
                sns_account = #{snsAccount},
            </if>
            <if test="snsUrl != null and snsUrl != ''">
                sns_url = #{snsUrl},
            </if>
            <if test="snsRegistDt != null">
                sns_regist_dt = #{snsRegistDt},
            </if>
            <if test="snsCreateDt != null and snsCreateDt != ''">
                sns_create_dt = #{snsCreateDt},
            </if>
            <if test="snsProfileImg != null and snsProfileImg != ''">
                sns_profile_img = #{snsProfileImg},
            </if>
            <if test="snsProfileBackgroundColor != null and snsProfileBackgroundColor != ''">
                sns_profile_background_color = #{snsProfileBackgroundColor},
            </if>
            <if test="snsProfileTextColor != null and snsProfileTextColor != ''">
                sns_profile_text_color = #{snsProfileTextColor},
            </if>
            <if test="snsProfileHttpsImg != null and snsProfileHttpsImg != ''">
                sns_profile_https_img = #{snsProfileHttpsImg},
            </if>
            <if test="snsName != null and snsName != ''">
                sns_name = #{snsName},
            </if>
            <if test="snsDescription != null and snsDescription != ''">
                sns_description = #{snsDescription},
            </if>
            <if test="stdrDt != null and stdrDt != ''">
                stdr_dt = #{stdrDt},
            </if>
            <if test="snsTimer != null and snsTimer != ''">
                sns_timer = #{snsTimer},
            </if>
            <if test="utmkX != null">
                utmk_x = #{utmkX},
            </if>
            <if test="utmkY != null">
                utmk_y = #{utmkY},
            </if>
            </set>
        WHERE
             sns_no = #{snsNo}
             AND  sns_id = #{snsId}
    </update>

    <delete id="deleteSnsInfo" parameterType="kr.or.lx.rcic.modules.snsInfo.entity.SnsInfo">
        /* kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper.deleteSnsInfo */

        DELETE FROM RCIC.TB_SNS_INFO
        WHERE
             sns_no = #{snsNo}
             AND  sns_id = #{snsId}
    </delete>

    <insert id="insertSnsInfo">
        /* kr.or.lx.rcic.modules.snsInfo.mapper.SnsInfoMapper.insertSnsInfo */
        INSERT INTO RCIC.TB_SNS_INFO
        (
        sns_no, sns_type, sns_keyword, sns_content, sns_account, sns_url, sns_regist_dt, sns_create_dt, sns_profile_img, sns_id, sns_profile_background_color, sns_profile_text_color, sns_profile_https_img, sns_name, sns_description, stdr_dt, sns_timer, utmk_x, utmk_y
        )
        VALUES (
        #{snsNo},
        #{snsType},
        #{snsKeyword},
        #{snsContent},
        #{snsAccount},
        #{snsUrl},
        #{snsRegistDt},
        #{snsCreateDt},
        #{snsProfileImg},
        #{snsId},
        #{snsProfileBackgroundColor},
        #{snsProfileTextColor},
        #{snsProfileHttpsImg},
        #{snsName},
        #{snsDescription},
        #{stdrDt},
        #{snsTimer},
        #{utmkX},
        #{utmkY}
        )
	</insert>

</mapper>

