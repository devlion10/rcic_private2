<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by Celerio, a Jaxio product.
 ! Documentation: http://www.jaxio.com/documentation/celerio/
 ! Follow us on twitter: @jaxiosoft
 ! Need commercial support ? Contact us: info@jaxio.com
 ! Template pack-rcic:src/main/resources/sqlmap/modules/SqlMap.e.vm.xml
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.lx.rcic.modules.dataapi.mapper.ApiUseDtlMapper">

    <resultMap id="apiUseDtlResultMap" type="kr.or.lx.rcic.modules.dataapi.entity.ApiUseDtl">
        <!-- API사용자번호 -->
        <result property="apiUserNo" column="api_user_no"/>
        <!-- API제공번호 -->
        <result property="apiProvdNo" column="api_provd_no"/>
        <!-- 사용일자 -->
        <result property="useDe" column="use_de"/>
        <!-- 사용시각 -->
        <result property="useHms" column="use_hms"/>
        <!-- 결과코드 -->
        <result property="resultCd" column="result_cd"/>
        <!-- 요청파라미터 -->
        <result property="requstParam" column="requst_param"/>
        <!-- 제공건수 -->
        <result property="provdCo" column="provd_co"/>
        <!-- 등록일시 -->
        <result property="registDt" column="regist_dt"/>
        <!-- 수정일시 -->
        <result property="updtDt" column="updt_dt"/>
    </resultMap>

    <sql id="whereConditions">
        <where>
            <include refid="conditions" />
        </where>
    </sql>

    <sql id="conditions">
        <if test="apiUserNo != null">
            AND api_user_no = #{apiUserNo}
        </if>
        <if test="apiProvdNo != null">
            AND api_provd_no = #{apiProvdNo}
        </if>
        <if test="useDe != null and useDe != ''">
            AND use_de = #{useDe}
        </if>
        <if test="useHms != null and useHms != ''">
            AND use_hms = #{useHms}
        </if>
        <if test="resultCd != null and resultCd != ''">
            AND result_cd = #{resultCd}
        </if>
        <if test="requstParam != null and requstParam != ''">
            AND requst_param = #{requstParam}
        </if>
        <if test="provdCo != null">
            AND provd_co = #{provdCo}
        </if>
        <if test="registDt != null and registDt.enabled == true">
            
            <if test="registDtEq != null and registDtEq != ''">
            AND regist_dt = STR_TO_DATE(#{registDtEq}, '%Y.%m.%d')
            </if>
            
            <if test="registDtFrom != null and registDtFrom != ''">
            AND regist_dt <![CDATA[ >= ]]> STR_TO_DATE(#{registDtFrom}, '%Y.%m.%d')
            </if>

            <if test="registDtTo != null and registDtTo != ''">
            AND regist_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{registDtTo}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
        <if test="updtDt != null and updtDt.enabled == true">
            
            <if test="updtDtEq != null and updtDtEq != ''">
            AND updt_dt = STR_TO_DATE(#{updtDtEq}, '%Y.%m.%d')
            </if>
            
            <if test="updtDtFrom != null and updtDtFrom != ''">
            AND updt_dt <![CDATA[ >= ]]> STR_TO_DATE(#{updtDtFrom}, '%Y.%m.%d')
            </if>

            <if test="updtDtTo != null and updtDtTo != ''">
            AND updt_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{updtDtTo}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
    </sql>

    <select id="getApiUseDtl" resultMap="apiUseDtlResultMap">
        /* kr.or.lx.rcic.modules.apiUseDtl.mapper.ApiUseDtlMapper.getApiUseDtl */

        SELECT
            api_user_no, api_provd_no, use_de, use_hms, result_cd, requst_param, provd_co, regist_dt, updt_dt
        FROM rcic.tb_api_use_dtl
        WHERE
         api_user_no = #{apiUserNo}
         AND  api_provd_no = #{apiProvdNo}
         AND  use_de = #{useDe}
         AND  use_hms = #{useHms}
	</select>

    <select id="selectApiUseDtlCnt" resultType="int">
        /* kr.or.lx.rcic.modules.dataapi.mapper.ApiUseDtlMapper.simpleListApiUseDtlCnt */

        SELECT COUNT(*)
        FROM rcic.tb_api_use_dtl
        <include refid="whereConditions" />
    </select>

    
    <select id="selectApiUseDtlList" resultType="egovMap">
        /* kr.or.lx.rcic.modules.dataapi.mapper.ApiUseDtlMapper.selectApiUseDtlList */

        <include refid="common.headerRow"/>
        SELECT
            api_user_no, api_provd_no, use_de, use_hms, result_cd, requst_param, provd_co, regist_dt, updt_dt
        FROM rcic.tb_api_use_dtl
        <include refid="whereConditions" />
        <include refid="common.footerRow"/>
	</select>

    <update id="updateApiUseDtl" parameterType="kr.or.lx.rcic.modules.dataapi.entity.ApiUseDtl">
        /* kr.or.lx.rcic.modules.apiUseDtl.mapper.ApiUseDtlMapper.updateApiUseDtl */

        UPDATE rcic.tb_api_use_dtl
        SET
               result_cd = #{resultCd}
                    , requst_param = #{requstParam}
                    , provd_co = #{provdCo}
                      , updt_dt = NOW()
              WHERE
             api_user_no = #{apiUserNo}
             AND  api_provd_no = #{apiProvdNo}
             AND  use_de = #{useDe}
             AND  use_hms = #{useHms}
    </update>

    <update id="updateApiUseDtlDynamic" parameterType="kr.or.lx.rcic.modules.dataapi.entity.ApiUseDtl">
        /* kr.or.lx.rcic.modules.dataapi.mapper.ApiUseDtlMapper.updateApiUseDtlDynamic */

        UPDATE rcic.tb_api_use_dtl
            <set>
            <if test="resultCd != null and resultCd != ''">
                result_cd = #{resultCd},
            </if>
            <if test="requstParam != null and requstParam != ''">
                requst_param = #{requstParam},
            </if>
            <if test="provdCo != null">
                provd_co = #{provdCo},
            </if>
            <if test="registDt != null">
                regist_dt = #{registDt},
            </if>
            <if test="updtDt != null">
                updt_dt = NOW(),
            </if>
            </set>
        WHERE
             api_user_no = #{apiUserNo}
             AND  api_provd_no = #{apiProvdNo}
             AND  use_de = #{useDe}
             AND  use_hms = #{useHms}
    </update>

    <delete id="deleteApiUseDtl" parameterType="kr.or.lx.rcic.modules.dataapi.entity.ApiUseDtl">
        /* kr.or.lx.rcic.modules.apiUseDtl.mapper.ApiUseDtlMapper.deleteApiUseDtl */

        DELETE FROM rcic.tb_api_use_dtl
        WHERE
             api_user_no = #{apiUserNo}
             AND  api_provd_no = #{apiProvdNo}
             AND  use_de = #{useDe}
             AND  use_hms = #{useHms}
    </delete>

    <insert id="insertApiUseDtl">
        /* kr.or.lx.rcic.modules.apiUseDtl.mapper.ApiUseDtlMapper.insertApiUseDtl */
        INSERT INTO rcic.tb_api_use_dtl
        (
        api_user_no, api_provd_no, use_de, use_hms, result_cd, requst_param, provd_co, regist_dt, updt_dt
        )
        VALUES (
        #{apiUserNo},
        #{apiProvdNo},
        #{useDe},
        #{useHms},
        #{resultCd},
        #{requstParam},
        #{provdCo},
        NOW(),
        NOW()
        )
	</insert>

</mapper>

