<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by Celerio, a Jaxio product.
 ! Documentation: http://www.jaxio.com/documentation/celerio/
 ! Follow us on twitter: @jaxiosoft
 ! Need commercial support ? Contact us: info@jaxio.com
 ! Template pack-rcic:src/main/resources/sqlmap/modules/SqlMap.e.vm.xml
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.lx.rcic.modules.initiationReport.mapper.InitiationReportMapper">
    <!-- 착수신고현황 - 조회 - 착수신고서 리스트 조회 -->
    <select id="getInitiationReportList" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        <include refid="common.headerRow"/>
        /* InitiationReportMapper.getInitiationReportList */
        SELECT ROW_NUMBER() OVER (ORDER BY REG_DT DESC) AS RN
        , SEQ
        , BIDNTCENO
        , ROAD_TYPE_CD
        , ROAD_TYPE_NM
        , CSTRN_NM
        , ROAD_RTE_NO
        , CSTRN_TYPE_CD
        , CSTRN_TYPE_NM
        , SUB_CSTRN_CNT
        , CSTRN_ST_DT
        , CSTRN_END_DT
        , substring(CSTRN_ST_DT, 1, 4) || '-' || substring(CSTRN_ST_DT, 5, 2) || '-' || substring(CSTRN_ST_DT, 7, 2) || ' ~ ' || substring(CSTRN_END_DT, 1, 4) || '-' || substring(CSTRN_END_DT, 5, 2) || '-' || substring(CSTRN_END_DT, 7, 2) AS CSTRN_DT
        FROM RCIC.TB_INITIATION_RPT
        WHERE 1=1
        <if test='bidntceno != null and bidntceno != ""'>
            AND BIDNTCENO = #{bidntceno}
        </if>
        <if test='cstrnTypeCd != null and cstrnTypeCd != "all"'>
            AND CSTRN_TYPE_CD = #{cstrnTypeCd}
        </if>
        <if test='roadTypeCd != null and roadTypeCd != "all"'>
            AND ROAD_TYPE_CD = #{roadTypeCd}
        </if>
        <if test='sido != "0"'>
            AND SIDO_CD = #{sido}
        </if>
        <if test='sgg != "0"'>
            AND SGG_CD = #{sgg}
        </if>
        <if test='emd != "0"'>
            AND EMD_CD = #{emd}
        </if>
        <if test='cstrnStDt != null and cstrnStDt != ""'>
            <![CDATA[
               AND CSTRN_ST_DT >= #{cstrnStDt}
               ]]>
        </if>
        <if test='cstrnEndDt != null and cstrnEndDt != ""'>
            <![CDATA[
               AND CSTRN_END_DT <= #{cstrnEndDt}
               ]]>
        </if>
        <if test='keywordSb == "cstrnNm" and keyword != null and keyword != ""'>
            AND CSTRN_NM LIKE CONCAT('%',#{keyword},'%')
        </if>
        <if test='keywordSb == "roadRteNo" and keyword != null and keyword != ""'>
            AND ROAD_RTE_NO LIKE CONCAT('%',#{keyword},'%')
        </if>
        <if test='keywordSb == "all" and keyword != null and keyword != ""'>
            AND (CSTRN_NM LIKE CONCAT('%',#{keyword},'%') OR ROAD_RTE_NO LIKE CONCAT('%',#{keyword},'%') OR DCL_NM LIKE CONCAT('%',#{keyword},'%'))
        </if>
        ORDER BY REG_DT DESC
        <include refid="common.footerRow"/>
    </select>

    <!-- 착수신고현황 - 조회 - 착수신고서 카운트 조회 -->
    <select id="getInitiationReportListCnt" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="int">
        /* InitiationReportMapper.getInitiationReportListCnt */
        SELECT COUNT(*)
        FROM RCIC.TB_INITIATION_RPT
        WHERE 1=1
        <if test='bidntceno != null and bidntceno != ""'>
            AND BIDNTCENO = #{bidntceno}
        </if>
        <if test='cstrnTypeCd != null and cstrnTypeCd != "all"'>
            AND CSTRN_TYPE_CD = #{cstrnTypeCd}
        </if>
        <if test='roadTypeCd != null and roadTypeCd != "all"'>
            AND ROAD_TYPE_CD = #{roadTypeCd}
        </if>
        <if test='sido != "0"'>
            AND SIDO_CD = #{sido}
        </if>
        <if test='sgg != "0"'>
            AND SGG_CD = #{sgg}
        </if>
        <if test='emd != "0"'>
            AND EMD_CD = #{emd}
        </if>
        <if test='cstrnStDt != null and cstrnStDt != ""'>
            <![CDATA[
               AND CSTRN_ST_DT >= #{cstrnStDt}
               ]]>
        </if>
        <if test='cstrnEndDt != null and cstrnEndDt != ""'>
            <![CDATA[
               AND CSTRN_END_DT <= #{cstrnEndDt}
               ]]>
        </if>
        <if test='keywordSb == "cstrnNm" and keyword != null and keyword != ""'>
            AND CSTRN_NM LIKE CONCAT('%',#{keyword},'%')
        </if>
        <if test='keywordSb == "roadRteNo" and keyword != null and keyword != ""'>
            AND ROAD_RTE_NO LIKE CONCAT('%',#{keyword},'%')
        </if>
        <if test='keywordSb == "all" and keyword != null and keyword != ""'>
            AND (CSTRN_NM LIKE CONCAT('%',#{keyword},'%') OR ROAD_RTE_NO LIKE CONCAT('%',#{keyword},'%') OR DCL_NM LIKE CONCAT('%',#{keyword},'%'))
        </if>
        <!--  
        	<include refid="whereConditions"/>
     	-->
    </select>

    <!-- SELECT BOX 공통코드 조회 (cdid: 00=관리청, 01=공사종류, 02=도로종류) -->
    <select id="getComCodeList" parameterType="String" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getComCodeList */
        SELECT CDID
             , CDKEY
             , CDVALUE
        FROM RCIC.TB_COM_CODE
        WHERE CDID = #{cdid}
    </select>

    <!-- 착수신고현황 - 등록/수정 - 공사시행위치(시/도) SELECT BOX -->
    <select id="getSidoList" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getSidoList */
        SELECT SIDO_CD AS sido
             , SIDO_NM
        FROM RCIC.TB_LEGALDONG_SIDO
    </select>

    <!-- 착수신고현황 - 등록/수정 - 공사시행위치(시/군/구) SELECT BOX -->
    <select id="getSggList" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getSggList */
        SELECT SGG_CD AS sgg
             , SGG_NM
        FROM RCIC.TB_LEGALDONG_SGG
        WHERE SIDO_CD = #{sido}
    </select>

    <!-- 착수신고현황 - 등록/수정 - 공사시행위치(읍/면/동) SELECT BOX -->
    <select id="getEmdList" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getEmdList */
        SELECT EMD_CD AS emd
             , EMD_NM
        FROM RCIC.TB_LEGALDONG_EMD
        WHERE SGG_CD = #{sgg}
    </select>

    <!-- 착수신고현황 - 등록/수정 - 입찰공고번호 정보 조회(tb_analysis_Info) -->
    <select id="getAnalysisBidntceno" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getAnalysisBidntceno */
        SELECT BIDNTCENO
             , CONST_ROAD_CLSS
             , CONST_ROAD_NM
             , COALESCE(SIDO_CD, '') AS sido
             , COALESCE(SGG_CD, '') AS sgg
             , COALESCE(EMD_CD, '') AS emd
             , COALESCE(SUBSTRING(FORECAST_ST_DT, 1, 4) ||'-'|| SUBSTRING(FORECAST_ST_DT, 5, 2) ||'-'|| SUBSTRING(FORECAST_ST_DT, 7, 2), '') AS cstrnStDt
             , COALESCE(SUBSTRING(forecast_end_dt, 1, 4) ||'-'|| SUBSTRING(forecast_end_dt, 5, 2) ||'-'|| SUBSTRING(forecast_end_dt, 7, 2), '') AS cstrnEndDt
        FROM RCIC.TB_ANALYSIS_INFO
        WHERE BIDNTCENO = #{bidntceno}
    </select>

    <!-- 착수신고현황 - 등록 - 착수신고서 등록(메인, initiation_rpt_appr_flag(관리청승인), 0=대기, 1=승인) -->
    <insert id="insertInitiationReportRegist" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.insertInitiationReportRegist */
        INSERT INTO RCIC.TB_INITIATION_RPT
             (
               seq
             , bidntceno
             , bidntcenoyn
             , work_division_info
             , dcl_nm
             , brno
             , dcl_addr
             , road_type_cd
             , road_type_Nm
             , sub_cstrn_cnt
             , ntnlty_land_mng_ofc_cd
             , ntnlty_land_mng_ofc_Nm
             , initiation_rpt_appr_flag
             , road_rte_no
             , cstrn_type_cd
             , cstrn_type_Nm
             , cstrn_nm
             , cstrn_st_dt
             , cstrn_end_dt
             , sido_cd
             , sido_nm
             , sgg_cd
             , sgg_nm
             , emd_cd
             , emd_nm
             , earth_mountain_cd
             , earth_mountain_nm
             , bon
             , bu
             , cstrn_loc_map_file_origin_nm
             , cstrn_loc_map_file_nm
             , cstrn_loc_map_file_size
             , cstrn_loc_map_file_path
             , cstrn_loc_map_file_type
             , reg_id
             , reg_dt
             )
        VALUES
             (
               (select COALESCE(MAX(SEQ)+1, 1) from RCIC.TB_INITIATION_RPT)
             , #{bidntceno, jdbcType=VARCHAR}
             , #{bidntcenoyn, jdbcType=VARCHAR}
             , #{workDivisionInfo, jdbcType=VARCHAR}
             , #{dclNm, jdbcType=VARCHAR}
             , #{brno, jdbcType=VARCHAR}
             , #{dclAddr, jdbcType=VARCHAR}
             , #{roadTypeCd, jdbcType=VARCHAR}
             , #{roadTypeNm, jdbcType=VARCHAR}
             , #{subCstrnCnt, jdbcType=VARCHAR}
             , #{ntnltyLandMngOfcCd, jdbcType=VARCHAR}
             , #{ntnltyLandMngOfcNm, jdbcType=VARCHAR}
             , '0'
             , #{roadRteNo, jdbcType=VARCHAR}
             , #{cstrnTypeCd, jdbcType=VARCHAR}
             , #{cstrnTypeNm, jdbcType=VARCHAR}
             , #{cstrnNm, jdbcType=VARCHAR}
             , #{cstrnStDt, jdbcType=VARCHAR}
             , #{cstrnEndDt, jdbcType=VARCHAR}
             , #{sido, jdbcType=VARCHAR}
             , #{sidoNm, jdbcType=VARCHAR}
             , #{sgg, jdbcType=VARCHAR}
             , #{sggNm, jdbcType=VARCHAR}
             , #{emd, jdbcType=VARCHAR}
             , #{emdNm, jdbcType=VARCHAR}
             , #{earthMountainCd, jdbcType=VARCHAR}
             , #{earthMountainNm, jdbcType=VARCHAR}
             , #{bon, jdbcType=VARCHAR}
             , #{bu, jdbcType=VARCHAR}
             , #{cstrnLocMapFileOriginNm}
             , #{cstrnLocMapFileNm}
             , #{cstrnLocMapFileSize}
             , #{cstrnLocMapFilePath}
             , #{cstrnLocMapFileType}
             , #{regId, jdbcType=VARCHAR}
             , TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
             )
    </insert>

    <!-- 착수신고현황 - 등록 - 착수신고서 등록(세부공사) -->
    <insert id="insertInitiationReportSubRegist" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.insertInitiationReportSubRegist */
        INSERT INTO RCIC.TB_INITIATION_RPT_SUB
             (
               init_rpt_seq
             , init_rpt_sub_seq
             , sub_cstrn_nm
             , sub_cstrn_st_dt
             , sub_cstrn_end_dt
             , sub_cstrn_st_loc_addr
             , sub_cstrn_st_cood_longitude
             , sub_cstrn_st_cood_latitude
             , sub_cstrn_st_dir
             , sub_cstrn_end_loc_addr
             , sub_cstrn_end_cood_longitude
             , sub_cstrn_end_cood_latitude
             , sub_cstrn_end_dir
             , sub_cstrn_loc_map_file_origin_nm
             , sub_cstrn_loc_map_file_nm
             , sub_cstrn_loc_map_file_size
             , sub_cstrn_loc_map_file_path
             , sub_cstrn_loc_map_file_type
             , sub_cstrn_st_loc_map_file_origin_nm
             , sub_cstrn_st_loc_map_file_nm
             , sub_cstrn_st_loc_map_file_size
             , sub_cstrn_st_loc_map_file_path
             , sub_cstrn_st_loc_map_file_type
             , sub_cstrn_end_loc_map_file_origin_nm
             , sub_cstrn_end_loc_map_file_nm
             , sub_cstrn_end_loc_map_file_size
             , sub_cstrn_end_loc_map_file_path
             , sub_cstrn_end_loc_map_file_type
             , sub_cstrn_reps_loc_map_file_origin_nm
             , sub_cstrn_reps_loc_map_file_nm
             , sub_cstrn_reps_loc_map_file_size
             , sub_cstrn_reps_loc_map_file_path
             , sub_cstrn_reps_loc_map_file_type
             , reg_id
             , reg_dt
             )
        VALUES
             (
               (SELECT MAX(seq) FROM RCIC.TB_INITIATION_RPT)
             , #{initRptSubSeq, jdbcType=VARCHAR}
             , #{subCstrnNm, jdbcType=VARCHAR}
             , #{subCstrnStDt, jdbcType=VARCHAR}
             , #{subCstrnEndDt, jdbcType=VARCHAR}
             , #{subCstrnStLocAddr, jdbcType=VARCHAR}
             , #{subCstrnStCoodLongitude, jdbcType=VARCHAR}
             , #{subCstrnStCoodLatitude, jdbcType=VARCHAR}
             , #{subCstrnStDir, jdbcType=VARCHAR}
             , #{subCstrnEndLocAddr, jdbcType=VARCHAR}
             , #{subCstrnEndCoodLongitude, jdbcType=VARCHAR}
             , #{subCstrnEndCoodLatitude, jdbcType=VARCHAR}
             , #{subCstrnEndDir, jdbcType=VARCHAR}
             , #{subCstrnLocMapFileOriginNm}
             , #{subCstrnLocMapFileNm}
             , #{subCstrnLocMapFileSize}
             , #{subCstrnLocMapFilePath}
             , #{subCstrnLocMapFileType}
             , #{subCstrnStLocMapFileOriginNm}
             , #{subCstrnStLocMapFileNm}
             , #{subCstrnStLocMapFileSize}
             , #{subCstrnStLocMapFilePath}
             , #{subCstrnStLocMapFileType}
             , #{subCstrnEndLocMapFileOriginNm}
             , #{subCstrnEndLocMapFileNm}
             , #{subCstrnEndLocMapFileSize}
             , #{subCstrnEndLocMapFilePath}
             , #{subCstrnEndLocMapFileType}
             , #{subCstrnRepsLocMapFileOriginNm}
             , #{subCstrnRepsLocMapFileNm}
             , #{subCstrnRepsLocMapFileSize}
             , #{subCstrnRepsLocMapFilePath}
             , #{subCstrnRepsLocMapFileType}
             , #{regId, jdbcType=VARCHAR}
             , TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
             )
    </insert>

    <!-- 착수신고현황 - 상세/수정 - 착수신고서 상세 조회(착수신고서 정보) -->
    <select id="getInitiationReportDetail" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getInitiationReportDetail */
        SELECT seq
             , bidntceno
             , bidntcenoyn
             , CASE WHEN bidntcenoyn = 'Y' THEN '유' ELSE '무' END AS bidntcenoynTxt
             , work_division_info
             , dcl_nm
             , brno
             , dcl_addr
             , road_type_cd
             , road_type_Nm
             , sub_cstrn_cnt
             , ntnlty_land_mng_ofc_cd
             , ntnlty_land_mng_ofc_Nm
             , initiation_rpt_appr_flag
             , road_rte_no
             , cstrn_type_cd
             , cstrn_type_nm
             , cstrn_nm
             , sido_cd AS sido
             , sido_nm
             , sgg_cd AS sgg
             , sgg_nm
             , emd_cd AS emd
             , emd_nm
             , earth_mountain_cd
             , earth_mountain_nm
             , bon
             , bu
             , cstrn_loc_map_file_origin_nm
             , cstrn_loc_map_file_nm
             , cstrn_loc_map_file_size
             , cstrn_loc_map_file_path
             , cstrn_loc_map_file_type
             , substring(cstrn_st_dt, 1, 4) || '-' || substring(cstrn_st_dt, 5, 2) || '-' || substring(cstrn_st_dt, 7, 2) AS cstrn_st_dt
             , substring(cstrn_end_dt, 1, 4) || '-' || substring(cstrn_end_dt, 5, 2) || '-' || substring(cstrn_end_dt, 7, 2) AS cstrn_end_dt
             , initiation_rpt_appr_flag
             , reg_id
          FROM RCIC.TB_INITIATION_RPT
         WHERE seq = #{seq}
    </select>

    <!-- 착수신고현황 - 착수신고서 세부공사 정보 카운트 조회 -->
    <select id="getInitiationReportSubListCnt" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="int">
        /* InitiationReportMapper.getInitiationReportSubListCnt */
        SELECT COUNT(*)
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{seq}
    </select>


    <!-- 착수신고현황 - 상세/수정 - 착수신고서 상세 조회(세부공사) -->
    <select id="getInitiationReportSubListDetail" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getInitiationReportSubListDetail */
        SELECT init_rpt_seq
             , init_rpt_sub_seq
             , sub_cstrn_nm
             , substring(sub_cstrn_st_dt, 1, 4) || '-' || substring(sub_cstrn_st_dt, 5, 2) || '-' || substring(sub_cstrn_st_dt, 7, 2) AS sub_cstrn_st_dt
             , substring(sub_cstrn_end_dt, 1, 4) || '-' || substring(sub_cstrn_end_dt, 5, 2) || '-' || substring(sub_cstrn_end_dt, 7, 2) AS sub_cstrn_end_dt
             , sub_cstrn_st_loc_addr
             , sub_cstrn_st_cood_longitude
             , sub_cstrn_st_cood_latitude
             , sub_cstrn_st_dir
             , sub_cstrn_end_loc_addr
             , sub_cstrn_end_cood_longitude
             , sub_cstrn_end_cood_latitude
             , sub_cstrn_end_dir
             , sub_cstrn_loc_map_file_origin_nm
             , sub_cstrn_loc_map_file_nm
             , sub_cstrn_loc_map_file_size
             , sub_cstrn_loc_map_file_path
             , sub_cstrn_loc_map_file_type
             , sub_cstrn_st_loc_map_file_origin_nm
             , sub_cstrn_st_loc_map_file_nm
             , sub_cstrn_st_loc_map_file_size
             , sub_cstrn_st_loc_map_file_path
             , sub_cstrn_st_loc_map_file_type
             , sub_cstrn_end_loc_map_file_origin_nm
             , sub_cstrn_end_loc_map_file_nm
             , sub_cstrn_end_loc_map_file_size
             , sub_cstrn_end_loc_map_file_path
             , sub_cstrn_end_loc_map_file_type
             , sub_cstrn_reps_loc_map_file_origin_nm
             , sub_cstrn_reps_loc_map_file_nm
             , sub_cstrn_reps_loc_map_file_size
             , sub_cstrn_reps_loc_map_file_path
             , sub_cstrn_reps_loc_map_file_type
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{seq}
         ORDER BY reg_dt DESC
    </select>

    <!-- 착수신고현황 - 수정 - 착수신고서(메인) 수정 -->
    <update id="updateInitiationReportUpdate">
        /* InitiationReportMapper.updateInitiationReportUpdate */
        UPDATE RCIC.TB_INITIATION_RPT
           SET bidntceno = #{bidntceno}
             , bidntcenoyn = #{bidntcenoyn}
             , dcl_nm = #{dclNm}
             , brno = #{brno}
             , dcl_addr = #{dclAddr}
             , road_type_cd = #{roadTypeCd}
             , road_type_nm = #{roadTypeNm}
             , cstrn_type_cd = #{cstrnTypeCd}
             , cstrn_type_nm = #{cstrnTypeNm}
             , road_rte_no = #{roadRteNo}
             , ntnlty_land_mng_ofc_cd = #{ntnltyLandMngOfcCd}
             , ntnlty_land_mng_ofc_nm = #{ntnltyLandMngOfcNm}
             , cstrn_nm = #{cstrnNm}
             , cstrn_st_dt = #{cstrnStDt}
             , cstrn_end_dt = #{cstrnEndDt}
             , sub_cstrn_cnt = #{subCstrnCnt}
             , sido_cd = #{sido}
             , sido_nm = #{sidoNm}
             , sgg_cd = #{sgg}
             , sgg_nm = #{sggNm}
             , emd_cd = #{emd}
             , emd_nm = #{emdNm}
             , earth_mountain_cd = #{earthMountainCd}
             , earth_mountain_nm = #{earthMountainNm}
             , bon = #{bon}
             , bu = #{bu}
             <if test="cstrnLocMapFileNm != null">
             , cstrn_loc_map_file_origin_nm = #{cstrnLocMapFileOriginNm}
             , cstrn_loc_map_file_nm = #{cstrnLocMapFileNm}
             , cstrn_loc_map_file_size = #{cstrnLocMapFileSize}
             , cstrn_loc_map_file_path = #{cstrnLocMapFilePath}
             , cstrn_loc_map_file_type = #{cstrnLocMapFileType}
             </if>
             , update_id = #{regId}
             , update_dt = TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
         WHERE seq = #{seq}
    </update>

    <!-- 착수신고현황 - 수정 - 착수신고서(세부공사) 수정 -->
    <update id="updateInitiationReportSubUpdate">
        /* InitiationReportMapper.updateInitiationReportSubUpdate */
        INSERT INTO RCIC.TB_INITIATION_RPT_SUB
             (
               init_rpt_seq
             , init_rpt_sub_seq
             , sub_cstrn_nm
             , sub_cstrn_st_dt
             , sub_cstrn_end_dt
             , sub_cstrn_st_loc_addr
             , sub_cstrn_st_cood_longitude
             , sub_cstrn_st_cood_latitude
             , sub_cstrn_st_dir
             , sub_cstrn_end_loc_addr
             , sub_cstrn_end_cood_longitude
             , sub_cstrn_end_cood_latitude
             , sub_cstrn_end_dir
             , sub_cstrn_loc_map_file_origin_nm
             , sub_cstrn_loc_map_file_nm
             , sub_cstrn_loc_map_file_size
             , sub_cstrn_loc_map_file_path
             , sub_cstrn_loc_map_file_type
             , sub_cstrn_st_loc_map_file_origin_nm
             , sub_cstrn_st_loc_map_file_nm
             , sub_cstrn_st_loc_map_file_size
             , sub_cstrn_st_loc_map_file_path
             , sub_cstrn_st_loc_map_file_type
             , sub_cstrn_end_loc_map_file_origin_nm
             , sub_cstrn_end_loc_map_file_nm
             , sub_cstrn_end_loc_map_file_size
             , sub_cstrn_end_loc_map_file_path
             , sub_cstrn_end_loc_map_file_type
             , sub_cstrn_reps_loc_map_file_origin_nm
             , sub_cstrn_reps_loc_map_file_nm
             , sub_cstrn_reps_loc_map_file_size
             , sub_cstrn_reps_loc_map_file_path
             , sub_cstrn_reps_loc_map_file_type
             , update_id
             , update_dt
             )
        VALUES
             (
               #{seq}
             , #{initRptSubSeq}
             , #{subCstrnNm}
             , #{subCstrnStDt}
             , #{subCstrnEndDt}
             , #{subCstrnStLocAddr}
             , #{subCstrnStCoodLongitude}
             , #{subCstrnStCoodLatitude}
             , #{subCstrnStDir}
             , #{subCstrnEndLocAddr}
             , #{subCstrnEndCoodLongitude}
             , #{subCstrnEndCoodLatitude}
             , #{subCstrnEndDir}
             , #{subCstrnLocMapFileOriginNm}
             , #{subCstrnLocMapFileNm}
             , #{subCstrnLocMapFileSize}
             , #{subCstrnLocMapFilePath}
             , #{subCstrnLocMapFileType}
             , #{subCstrnStLocMapFileOriginNm}
             , #{subCstrnStLocMapFileNm}
             , #{subCstrnStLocMapFileSize}
             , #{subCstrnStLocMapFilePath}
             , #{subCstrnStLocMapFileType}
             , #{subCstrnEndLocMapFileOriginNm}
             , #{subCstrnEndLocMapFileNm}
             , #{subCstrnEndLocMapFileSize}
             , #{subCstrnEndLocMapFilePath}
             , #{subCstrnEndLocMapFileType}
             , #{subCstrnRepsLocMapFileOriginNm}
             , #{subCstrnRepsLocMapFileNm}
             , #{subCstrnRepsLocMapFileSize}
             , #{subCstrnRepsLocMapFilePath}
             , #{subCstrnRepsLocMapFileType}
             , #{regId}
             , TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
             )
     ON CONFLICT ON CONSTRAINT tb_initiation_rpt_sub_pk
     DO UPDATE
           SET sub_cstrn_nm = #{subCstrnNm}
             , sub_cstrn_st_dt = #{subCstrnStDt}
             , sub_cstrn_end_dt = #{subCstrnEndDt}
             , sub_cstrn_st_loc_addr = #{subCstrnStLocAddr}
             , sub_cstrn_st_cood_longitude = #{subCstrnStCoodLongitude}
             , sub_cstrn_st_cood_latitude = #{subCstrnStCoodLatitude}
             , sub_cstrn_st_dir = #{subCstrnStDir}
             , sub_cstrn_end_loc_addr = #{subCstrnEndLocAddr}
             , sub_cstrn_end_cood_longitude = #{subCstrnEndCoodLongitude}
             , sub_cstrn_end_cood_latitude = #{subCstrnEndCoodLatitude}
             , sub_cstrn_end_dir = #{subCstrnEndDir}
             <if test="subCstrnLocMapFileNm != null">
             , sub_cstrn_loc_map_file_origin_nm = #{subCstrnLocMapFileOriginNm}
             , sub_cstrn_loc_map_file_nm = #{subCstrnLocMapFileNm}
             , sub_cstrn_loc_map_file_size = #{subCstrnLocMapFileSize}
             , sub_cstrn_loc_map_file_path = #{subCstrnLocMapFilePath}
             , sub_cstrn_loc_map_file_type = #{subCstrnLocMapFileType}
             </if>
             <if test="subCstrnStLocMapFileNm != null">
             , sub_cstrn_st_loc_map_file_origin_nm = #{subCstrnStLocMapFileOriginNm}
             , sub_cstrn_st_loc_map_file_nm = #{subCstrnStLocMapFileNm}
             , sub_cstrn_st_loc_map_file_size = #{subCstrnStLocMapFileSize}
             , sub_cstrn_st_loc_map_file_path = #{subCstrnStLocMapFilePath}
             , sub_cstrn_st_loc_map_file_type = #{subCstrnStLocMapFileType}
             </if>
             <if test="subCstrnEndLocMapFileNm != null">
             , sub_cstrn_end_loc_map_file_origin_nm = #{subCstrnEndLocMapFileOriginNm}
             , sub_cstrn_end_loc_map_file_nm = #{subCstrnEndLocMapFileNm}
             , sub_cstrn_end_loc_map_file_size = #{subCstrnEndLocMapFileSize}
             , sub_cstrn_end_loc_map_file_path = #{subCstrnEndLocMapFilePath}
             , sub_cstrn_end_loc_map_file_type = #{subCstrnEndLocMapFileType}
             </if>
             <if test="subCstrnRepsLocMapFileNm != null">
             , sub_cstrn_reps_loc_map_file_origin_nm = #{subCstrnRepsLocMapFileOriginNm}
             , sub_cstrn_reps_loc_map_file_nm = #{subCstrnRepsLocMapFileNm}
             , sub_cstrn_reps_loc_map_file_size = #{subCstrnRepsLocMapFileSize}
             , sub_cstrn_reps_loc_map_file_path = #{subCstrnRepsLocMapFilePath}
             , sub_cstrn_reps_loc_map_file_type = #{subCstrnRepsLocMapFileType}
             </if>
             , update_id = #{regId}
             , update_dt = TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
    </update>

    <!-- 착수신고현황 - 상세 - 착수신고서 관리청 승인 -->
    <update id="initiationReportApprUpdate" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.initiationReportApprUpdate */
        UPDATE RCIC.TB_INITIATION_RPT
           SET approver_id = #{approverId}
             , initiation_rpt_appr_flag = #{initiationRptApprFlag}
             , approver_dt = TO_CHAR(now(), 'YYYY-MM-DD HH24:MI:SS')
         WHERE seq = #{seq}
    </update>

    <!-- 착수신고현황 - 상세 - 착수신고서 관리청 승인 후 안전지킴이 API 파라미터 조회-->
    <select id="getInitiationReportApprInfo" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* InitiationReportMapper.getInitiationReportApprInfo */
        SELECT SEQ
             , APPROVER_NM
             , INITIATION_RPT_APPR_FLAG
          FROM RCIC.TB_INITIATION_RPT
         WHERE SEQ = #{seq}
    </select>

    <!-- 착수신고현황 - 삭제 - 공사정보삭제 -->
    <delete id="itiationReportDel" parameterType="String">
        /* InitiationReportMapper.itiationReportDel */
        DELETE FROM RCIC.TB_INITIATION_RPT WHERE seq = #{seq}
    </delete>

    <!-- 착수신고현황 - 삭제 - 세부공사정보삭제 -->
    <delete id="itiationReportSubDel" parameterType="String">
        /* InitiationReportMapper.itiationReportSubDel */
        DELETE FROM RCIC.TB_INITIATION_RPT_SUB WHERE init_rpt_seq = #{seq}
    </delete>

    <!-- 착수신고현황 - 상세 - 파일다운로드 파일정보 조회(메인) -->
    <select id="getAtchMasterFile" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* kr.or.lx.rcic.modules.bbsAtchFile.mapper.BbsAtchFileMapper.getBbsAtchFile */
        /* InitiationReportMapper.getAtchMasterFile */
        SELECT cstrn_loc_map_file_origin_nm
             , cstrn_loc_map_file_nm
             , cstrn_loc_map_file_path
             , cstrn_loc_map_file_type
        FROM rcic.TB_INITIATION_RPT
        WHERE seq = #{initRptSeq}
    </select>

    <!-- 착수신고현황 - 상세 - 파일다운로드 파일정보 조회(세부공사) -->
    <select id="getAtchFile" resultType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO">
        /* kr.or.lx.rcic.modules.bbsAtchFile.mapper.BbsAtchFileMapper.getBbsAtchFile */
        /* InitiationReportMapper.getAtchFile */
        SELECT
               sub_cstrn_loc_map_file_origin_nm
             , sub_cstrn_loc_map_file_nm
             , sub_cstrn_loc_map_file_path
             , sub_cstrn_loc_map_file_type
             , sub_cstrn_st_loc_map_file_origin_nm
             , sub_cstrn_st_loc_map_file_nm
             , sub_cstrn_st_loc_map_file_path
             , sub_cstrn_st_loc_map_file_type
             , sub_cstrn_end_loc_map_file_origin_nm
             , sub_cstrn_end_loc_map_file_nm
             , sub_cstrn_end_loc_map_file_path
             , sub_cstrn_end_loc_map_file_type
             , sub_cstrn_reps_loc_map_file_origin_nm
             , sub_cstrn_reps_loc_map_file_nm
             , sub_cstrn_reps_loc_map_file_path
             , sub_cstrn_reps_loc_map_file_type
          FROM rcic.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{initRptSeq}
           AND init_rpt_sub_seq = #{initRptSubSeq}
	</select>

    <!-- 착수신고현황 - 수정 - 삭제할 파일명 조회(전체공사위치도)-->
    <select id="getCstrnLocMapDelFileInfo" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="egovMap">
        /* InitiationReportMapper.getCstrnLocMapDelFileInfo */
        SELECT cstrn_loc_map_file_nm
             , cstrn_loc_map_file_path
          FROM RCIC.TB_INITIATION_RPT
         WHERE seq = #{seq}
    </select>

    <!-- 착수신고현황 - 수정 - 삭제할 파일명 조회(세부공사위치도)-->
    <select id="getSubCstrnLocMapDelFilename" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="String">
        /* InitiationReportMapper.getSubCstrnLocMapDelFilename */
        SELECT sub_cstrn_loc_map_file_nm
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{initRptSeq}
           AND init_rpt_sub_seq = #{initRptSubSeq}
    </select>

    <!-- 착수신고현황 - 수정 - 삭제할 파일명 조회(세부공사시점)-->
    <select id="getSubCstrnStLocMapDelFilename" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="String">
        /* InitiationReportMapper.getSubCstrnStLocMapDelFilename */
        SELECT sub_cstrn_st_loc_map_file_nm
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{initRptSeq}
           AND init_rpt_sub_seq = #{initRptSubSeq}
    </select>

    <!-- 착수신고현황 - 수정 - 삭제할 파일명 조회(세부공사종점)-->
    <select id="getSubCstrnEndLocMapDelFilename" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="String">
        /* InitiationReportMapper.getSubCstrnEndLocMapDelFilename */
        SELECT sub_cstrn_end_loc_map_file_nm
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{initRptSeq}
           AND init_rpt_sub_seq = #{initRptSubSeq}
    </select>

    <!-- 착수신고현황 - 수정 - 삭제할 파일명 조회(세부공사대표지점)-->
    <select id="getSubCstrnRepsLocMapDelFilename" parameterType="kr.or.lx.rcic.modules.initiationReport.entity.InitiationReportDTO" resultType="String">
        /* InitiationReportMapper.getSubCstrnRepsLocMapDelFilename */
        SELECT sub_cstrn_reps_loc_map_file_nm
          FROM RCIC.TB_INITIATION_RPT_SUB
         WHERE init_rpt_seq = #{initRptSeq}
           AND init_rpt_sub_seq = #{initRptSubSeq}
    </select>

    <select id="getInitiationReportSeq" resultType="Long">
        SELECT max(seq)
          FROM RCIC.TB_INITIATION_RPT
    </select>

</mapper>