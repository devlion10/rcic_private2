<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.lx.rcic.modules.menu.mapper.MenuMapper">

    <resultMap id="menuResultMap" type="kr.or.lx.rcic.modules.menu.entity.Menu">
        <!-- 메뉴번호 -->
        <result property="id" column="menu_no"/>
        <!-- 상위메뉴번호 -->
        <result property="upMenuNo" column="up_menu_no"/>
        <!-- 메뉴명 -->
        <result property="menuNm" column="menu_nm"/>
        <!-- 메뉴명 -->
        <result property="menuCd" column="menu_cd"/>
        <!-- 사용여부 -->
        <result property="useYn" column="use_yn"/>
        <!-- 등록일시 -->
        <result property="registDt" column="regist_dt"/>
        <!-- 등록아이디 -->
        <result property="registId" column="regist_id"/>
        <!-- 수정일시 -->
        <result property="updtDt" column="updt_dt"/>
        <!-- 수정아이디 -->
        <result property="updtId" column="updt_id"/>
    </resultMap>

    <sql id="whereConditions">
        <where>
            <include refid="conditions" />
        </where>
    </sql>

    <sql id="conditions">
        <if test="id != null">
            AND menu_no = #{id}
        </if>
        <if test="upMenuNo != null">
            AND up_menu_no = #{upMenuNo}
        </if>
        <if test="menuNm != null and menuNm != ''">
            AND menu_nm = #{menuNm}
        </if>
        <if test="useYn != null and useYn != ''">
            AND use_yn = #{useYn}
        </if>
        <if test="registDt != null and registDt.enabled == true">

            <if test="registDtEq != null and registDtEq != ''">
                AND regist_dt = STR_TO_DATE(#{registDtEq}, '%Y.%m.%d')
            </if>

            <if test="registDtFrom != null and registDtFrom != ''">
                AND regist_dt <![CDATA[ >= ]]> STR_TO_DATE(#{registDtFrom}, '%Y.%m.%d')
            </if>

            <if test="registDtTo != null and registDtTo != ''">
                AND regist_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{registDtTo}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
        <if test="registId != null and registId != ''">
            AND regist_id = #{registId}
        </if>
        <if test="updtDt != null and updtDt.enabled == true">

            <if test="updtDtEq != null and updtDtEq != ''">
                AND updt_dt = STR_TO_DATE(#{updtDtEq}, '%Y.%m.%d')
            </if>

            <if test="updtDtFrom != null and updtDtFrom != ''">
                AND updt_dt <![CDATA[ >= ]]> STR_TO_DATE(#{updtDtFrom}, '%Y.%m.%d')
            </if>

            <if test="updtDtTo != null and updtDtTo != ''">
                AND updt_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{updtDtTo}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
        <if test="updtId != null and updtId != ''">
            AND updt_id = #{updtId}
        </if>
    </sql>

    <select id="getMenu" resultMap="menuResultMap">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.getMenu */

        SELECT
            menu_no, up_menu_no, menu_nm, use_yn, regist_dt, regist_id, updt_dt, updt_id
        FROM rcic.tb_menu
        WHERE
         menu_no = #{id}
	</select>

    <select id="selectMenuCnt" resultType="int">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.simpleListMenuCnt */

        SELECT COUNT(*)
        FROM rcic.tb_menu
        <include refid="whereConditions" />
    </select>


    <select id="selectMenuList" resultType="egovMap">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.selectMenuList */

        <include refid="common.headerRow"/>
        SELECT
        menu_no, up_menu_no, menu_nm, use_yn, regist_dt, regist_id, updt_dt, updt_id
        FROM rcic.tb_menu
        <include refid="whereConditions" />
        <include refid="common.footerRow"/>
    </select>

    <select id="selectAdminMenuList" resultMap="menuResultMap">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.selectAdminMenuList */

        SELECT menu_no
             , up_menu_no
             , menu_nm
             , menu_cd
             , use_yn
             , regist_dt
             , regist_id
             , updt_dt
             , updt_id
        FROM rcic.tb_menu
    </select>

    <update id="updateMenu" parameterType="kr.or.lx.rcic.modules.menu.entity.Menu">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.updateMenu */

        UPDATE rcic.tb_menu
        SET
               up_menu_no = #{upMenuNo}
                    , menu_nm = #{menuNm}
                    , use_yn = #{useYn}
                        , updt_dt = NOW()
                    , updt_id = #{updtId}
              WHERE
             menu_no = #{id}
    </update>

    <update id="updateMenuDynamic" parameterType="kr.or.lx.rcic.modules.menu.entity.Menu">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.updateMenuDynamic */

        UPDATE rcic.tb_menu
        <set>
            <if test="upMenuNo != null">
                up_menu_no = #{upMenuNo},
            </if>
            <if test="menuNm != null and menuNm != ''">
                menu_nm = #{menuNm},
            </if>
            <if test="useYn != null and useYn != ''">
                use_yn = #{useYn},
            </if>
            <if test="registDt != null">
                regist_dt = #{registDt},
            </if>
            <if test="registId != null and registId != ''">
                regist_id = #{registId},
            </if>
            <if test="updtDt != null">
                updt_dt = NOW(),
            </if>
            <if test="updtId != null and updtId != ''">
                updt_id = #{updtId},
            </if>
        </set>
        WHERE
        menu_no = #{id}
    </update>

    <delete id="deleteMenu" parameterType="kr.or.lx.rcic.modules.menu.entity.Menu">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.deleteMenu */

        DELETE FROM rcic.tb_menu
        WHERE
             menu_no = #{id}
    </delete>

    <insert id="insertMenu">
        /* kr.or.lx.rcic.modules.menu.mapper.MenuMapper.insertMenu */
        INSERT INTO rcic.tb_menu
        (
        menu_no, up_menu_no, menu_nm, use_yn, regist_dt, regist_id, updt_dt, updt_id
        )
        VALUES (
        #{id},
        #{upMenuNo},
        #{menuNm},
        #{useYn},
        NOW(),
        #{registId},
        NOW(),
        #{updtId}
        )
	</insert>

</mapper>

