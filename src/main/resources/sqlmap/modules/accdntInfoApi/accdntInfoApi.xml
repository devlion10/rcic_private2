<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by Celerio, a Jaxio product.
 ! Documentation: http://www.jaxio.com/documentation/celerio/
 ! Follow us on twitter: @jaxiosoft
 ! Need commercial support ? Contact us: info@jaxio.com
 ! Template pack-rcic:src/main/resources/sqlmap/modules/SqlMap.e.vm.xml
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.lx.rcic.modules.accdntInfoApi.mapper.AccdntInfoApiMapper">

    <resultMap id="accdntInfoApiResultMap" type="kr.or.lx.rcic.modules.accdntInfoApi.entity.AccdntInfoApi">
        <!-- API 연계시간 (YYYYMMDDHH24MI) -->
        <result property="apiLinkDt" column="api_link_dt"/>
        <!-- 공사/사고구분 -->
        <result property="cntrwkAcdntSe" column="cntrwk_acdnt_se"/>
        <!-- 고유식별번호 -->
        <result property="esntlIdntfcNo" column="esntl_idntfc_no"/>
        <!-- 공사사고유형 -->
        <result property="cntrwkAcdntTy" column="cntrwk_acdnt_ty"/>
        <!-- 차로차단방법 -->
        <result property="cartrkIntrcpMth" column="cartrk_intrcp_mth"/>
        <!-- 차단된 차로수 -->
        <result property="blockLaneCnt" column="block_lane_cnt"/>
        <!-- 공사시작일 -->
        <result property="cntrwkBgnde" column="cntrwk_bgnde"/>
        <!-- 공사종료일 -->
        <result property="cntrwkEndde" column="cntrwk_endde"/>
        <!-- 공사실제개시시간 -->
        <result property="cntrwkRealBeginTime" column="cntrwk_real_begin_time"/>
        <!-- 공사실제종료시간 -->
        <result property="cntrwkRealEndTime" column="cntrwk_real_end_time"/>
        <!-- 돌발상황지속여부 -->
        <result property="outbrkSittnCntncAt" column="outbrk_sittn_cntnc_at"/>
        <!-- 상황정보 메시지 -->
        <result property="sittnInfoMssage" column="sittn_info_mssage"/>
        <!-- X좌표 -->
        <result property="utmkX" column="utmk_x"/>
        <!-- Y좌표 -->
        <result property="utmkY" column="utmk_y"/>
        <!-- WKT 변환좌표 (EPSG 3857) -->
        <result property="wktGeom" column="wkt_geom"/>
    </resultMap>

    <sql id="whereConditions">
        <where>
            <include refid="conditions" />
        </where>
    </sql>

    <sql id="conditions">
        <if test="apiLinkDt != null and apiLinkDt != ''">
            AND api_link_dt = #{apiLinkDt}
        </if>
        <if test="cntrwkAcdntSe != null and cntrwkAcdntSe != ''">
            AND cntrwk_acdnt_se = #{cntrwkAcdntSe}
        </if>
        <if test="esntlIdntfcNo != null and esntlIdntfcNo != ''">
            AND esntl_idntfc_no = #{esntlIdntfcNo}
        </if>
        <if test="cntrwkAcdntTy != null and cntrwkAcdntTy != ''">
            AND cntrwk_acdnt_ty = #{cntrwkAcdntTy}
        </if>
        <if test="cartrkIntrcpMth != null and cartrkIntrcpMth != ''">
            AND cartrk_intrcp_mth = #{cartrkIntrcpMth}
        </if>
        <if test="blockLaneCnt != null">
            AND block_lane_cnt = #{blockLaneCnt}
        </if>
        <if test="cntrwkBgnde != null and cntrwkBgnde != ''">
            AND cntrwk_bgnde = #{cntrwkBgnde}
        </if>
        <if test="cntrwkEndde != null and cntrwkEndde != ''">
            AND cntrwk_endde = #{cntrwkEndde}
        </if>
        <if test="cntrwkRealBeginTime != null and cntrwkRealBeginTime != ''">
            AND cntrwk_real_begin_time = #{cntrwkRealBeginTime}
        </if>
        <if test="cntrwkRealEndTime != null and cntrwkRealEndTime != ''">
            AND cntrwk_real_end_time = #{cntrwkRealEndTime}
        </if>
        <if test="outbrkSittnCntncAt != null and outbrkSittnCntncAt != ''">
            AND outbrk_sittn_cntnc_at = #{outbrkSittnCntncAt}
        </if>
        <if test="sittnInfoMssage != null and sittnInfoMssage != ''">
            AND sittn_info_mssage = #{sittnInfoMssage}
        </if>
        <if test="utmkX != null">
            AND utmk_x = #{utmkX}
        </if>
        <if test="utmkY != null">
            AND utmk_y = #{utmkY}
        </if>
        <if test="wktGeom != null and wktGeom != ''">
            AND wkt_geom = #{wktGeom}
        </if>
    </sql>

    <select id="getAccdntInfoApi" resultMap="accdntInfoApiResultMap">
        /* kr.or.lx.rcic.modules.accdntInfoApi.mapper.AccdntInfoApiMapper.getAccdntInfoApi */

        SELECT
            api_link_dt, cntrwk_acdnt_se, esntl_idntfc_no, cntrwk_acdnt_ty, cartrk_intrcp_mth, block_lane_cnt, cntrwk_bgnde, cntrwk_endde, cntrwk_real_begin_time, cntrwk_real_end_time, outbrk_sittn_cntnc_at, sittn_info_mssage, utmk_x, utmk_y, wkt_geom
        FROM rcic.tl_accdnt_info_api
        WHERE
         api_link_dt = #{apiLinkDt}
         AND  cntrwk_acdnt_se = #{cntrwkAcdntSe}
         AND  esntl_idntfc_no = #{esntlIdntfcNo}
	</select>

    <select id="selectAccdntInfoApiCnt" resultType="int">
        /* kr.or.lx.rcic.modules.accdntInfoApi.mapper.AccdntInfoApiMapper.simpleListAccdntInfoApiCnt */

        SELECT COUNT(*)
        FROM rcic.tl_accdnt_info_api
        <include refid="whereConditions" />
    </select>

    
    <select id="selectAccdntInfoApiList" resultType="egovMap">
        /* kr.or.lx.rcic.modules.accdntInfoApi.mapper.AccdntInfoApiMapper.selectAccdntInfoApiList */

        <include refid="common.headerRow"/>
        SELECT
            api_link_dt, cntrwk_acdnt_se, esntl_idntfc_no, cntrwk_acdnt_ty, cartrk_intrcp_mth, block_lane_cnt, cntrwk_bgnde, cntrwk_endde, cntrwk_real_begin_time, cntrwk_real_end_time, outbrk_sittn_cntnc_at, sittn_info_mssage, utmk_x, utmk_y, wkt_geom
        FROM rcic.tl_accdnt_info_api
        <include refid="whereConditions" />
        <include refid="common.footerRow"/>
	</select>
 
</mapper>

